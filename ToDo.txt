Автоматическое удаление флага read only - перед каждой операцией с записью с восстанволением, или вообще, или не трогать? Можно заюзать новый модный RAII-подобный using для этих целей.
Бэкап и роллбэк могут тоже оказаться с флагом readonly =(
Избежать перезаписи файла hosts при каждом CanWrite()... Сделать функцию CanWrite(), и в ней делать проверку только один раз, результат запоминать? Или по факту когда пишем результат - тогда и проверять.

del сразу нескольких хостов одной строкой?
rem veg.by www.veg.gy
удаление хостов сразу с алиасами или удаление хоста из строки без алиасов?
  rem  [--alias] <host|mask>                 - remove host or an alias
  rem  [--line] <host|mask>                  - remove full line or an alias
  rem  [--full] <host|mask>                  - remove full line or an alias
  rem  [--one] <host|mask>                   - remove full line or an alias
В "add" уже есть нужная логика для "rem --alias", вынести в отдельную функцию из адействовать.
Или вообще, rem - это удалять только алиасы (если есть), а del - это целыми строками. Имеет ли такое смысл?
В текущем смысле походу лучше заменить rem на del и REMOVED на DELETED. Ещё можно алиасы unset/erase заюзать.
exclude - для удаления только алиасов?

сложные фильтры типа *epic* && ([tag1] || [tag2])
Позволить в качестве маски использовать регулярки? Типа просто если текст между / и /, то это - регулярка.
теги! Вместо знака ! использовать тег [hidden]?

TODO
 - Hosts.Save() должна проверять, изменилось ли что, и только если изменилось - сохранять изменения. Там же флаг read only должен сниматься и возвращаться. Другие операции что перезаписывают hosts так же должны снимать и восстанавливать флаг только перед своей непосредственной работой.
 - Выводить в статистике количество невалидных строк, которые не являются комментариями.
 - Более умные маски для доментов: по умолчанию искать указанную строку между точками (:: для IPv6) или концом строки, автоматом * не добавлять. То есть, view local найдёт всё с *.local, но не localhost, например. А вот явно local* уже и localhost найдёт.
 - Вместо хоста и маски операции по IP? Типа вывести список хостов с таким-то IP, удалить хосты с таким-то IP, и т.д. Маски для IP тоже? Защита от удаления localhost?
 - По дефолту IP не учитывать, только при передаче --ip.
 - Специальные маски для IP в формате 192.168.1.1/16?
 - Подчистить этот список
 - add, replace и update как три способа работы с записями (строго добавление, полная перезапись и обновление сущетсвующих записей)
 - Команда set может работать только с одной записью, или с двумя версиями одной записи (ipv4 и ipv6), а вот update может работать с масками, но при этом он не может добавлять и удалять домены в строках
 - У всех ipv6 ставится скрытый тег IPV6, у всех ipv4 — IPV4, у скрытых ставится тег HIDDEN, у видимых — VISIBLE (при этом эти строки не нужно хранить в самом hosts, это и так понятно)
 - В интерактивном режиме при возникновении спорных ситуаций спрашивать пользователя
 - Раздельное управление ipv4 и ipv6 адресами (возможно через флаг ipv4 или ipv6 последним параметром)
 - Возможность изменять параметры конкретных алиасов (автоматический вынос из строки)
 - Как-то объединить код add/set/upd
 - Какой-то символ, который позволял бы объединять несколько операций (по аналогии с && в командной строке, но внутри команды hosts)
 - Если по требованию изменить свойство и оно на самом деле установлено в то же, что и было, выводить об этом инфу (например вместо SHOWN писать ALREADY)
 - группы хостов, для каждой группы свои настройки по умолчанию
 - или может быть лучше теги? [home], [work] и т.д. использовать вместо имени хоста или маски, [+work] добавит тег, [-work] удалит тег
 - при обновлении записи добавление и удаление алиасов: +domain.ru -domain.ru -* -*.domain.ru
 - профили: hosts profiles - список профилей, hosts setprofile work - выбрать профиль
 - или их заменят группы? или профили на основе текущих backup / restore? с новыми именами save / load?
 - При запуске командного интерпретатора без прав суперпользователя выводить предупреждение об этом
 - При запуске под Mono в командном интерпретаторе не работают стрелки вверх-вниз (просмотр предыдущих команд) и вправо-влево (перемещение курсора по строке) — проблема в Console.ReadLine(), отправить баг-репорт в Xamarin
 - Может ввести настройки (ширина колонок при выводе в консоль, при форматировании файла hosts, различные режимы по умолчанию)? Сохранять их в каталог пользователя с именем hosts.ini :)
 - Убрать обязательность соглашаться с UAC
 - Внутри hosts команда su для запуска своего интерпретатора с правами пользователя
 - Вместе с hosts можно поставлять утилитку su
 - Реализация open под Linux / Mac: в линуксе есть ENV переменная $EDITOR, через эту переменную можн опереопределять дефолтный консольный редактор, также есть команда editor (но ее нужно тестить), а есть xdg-open
http://stackoverflow.com/questions/13627767/open-file-in-default-editor-from-bash, скорее всего нужен xdg-open, а консольный vi мне кажется есть в каждом адекватном линуксе
 - Операция explode (split) для разделения строки с алиасами
 - Операция implode (или merge? join?) для объединения нескольких строк в одну
 - Выводить сообщения через события ObservableCollection? Тогда можно внутрь HostsEditor вынести логику процедур
 - В HostsEditor добавить метод GetChanges (GetLog), который будет выводить лог с последнего сохранения, как-то фильтровать «не изменённые» изменения типа 127.0.0.1 заменили на 127.0.0.1?
 - Выводить изменения в виде diff (+ перед добавленными строками, - перед удалёнными, изменённые строки выводятся в виде двух строк с - и +)
 - Поскольку LINQ не работает с ObservableCollection, клонировать HostsEditor перед изменениями и делать diff между оригинальной и изменённой версией, в HostsItem можно добавить поле «номер строки в исходном файле» для точного определения изменившихся строк
 - Метод, сообщающий, изменится ли файл при сохранении (IsChanged?)
 - Добавить поддержку регулярок в паттерны (в формате /.*\.local/)
 - Hi, I'm just discover your hosts commander, very nice! It would be nice if your app can work with lmhosts instead hosts, is it possible to add as option ? add x.x.x.x computer #PRE  (very useful for vpn , with just hosts, there is slow issue) + "nbtstat -R" after updating lmhosts. What do you think ?
 - Чтобы не запрашивать сразу максимум прав можно сохранять отредактированный файл во временную папку, потом запускать самого себя с повышенными правами и копировать в нужное место
 - По умолчанию хранить всё в каталоге пользователя (Vegalogic/Hosts/), но если в текущем каталоге есть файл exename.ini, то работать в портабельном режиме
 - В ini файле настройки выравнивания при автоформатировании
 - Настройка где хранить бэкапы — в каталоге пользователя или там же где сам hosts :)
 - К exe файлу можно дописывать ini для значений по умолчанию (смещение ini вычислять по табличке секций, после последней секции аттач!)
 - Если в каталоге с exe лежит ini — работаем в портабельном режиме
 - Либо же при сохранении если не получается сохранить куда планировалось сохраняем в Temp/Vegalogic/Hosts/ и запускаем сами себя с повышенными привилегиями, чтобы из TEMP перенести файл куда нужно (команда apply)
 - IsPortable, UserDirectory (etc, user, local, roaming, mydocs, current) — свойства в главном классе Program
 - Запускать с повышенными правами отдельный процесс и общаться через Named Pipes — как вариант (позволит получать результат и т.д.)
 - можно ещё задействовать Job Objects чтобы оно само дохло в случае закрытия предка (придётся задействовать JobObjectWrapper, так как родного для .NET такого API нет)
 - Хотя лучше проще, и сделать подкоманду sudo/su для запуска консолки hosts с повышенными привелегиями, а другие команды при каждом выполнении при необходимости записи должны просить UAC (но вывод организовать в основное окно всё равно?)
